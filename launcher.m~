clear
clc

pic = double(imread('portrait.jpg'))/255;

% Set bilateral filter parameters.
w     = 5;       % bilateral filter half-width
sigma = [3 0.1]; % bilateral filter standard deviations

%bflt = bfilter2(pic,w,sigma);

% Apply bilateral filter for a "cartoon" effect.
cartoon = cartoon(pic);

%imshow(bflt);
figure;
imshow(cartoon);

bw = rgb2gray(cartoon);

% bw_cartn = cartoon(bw);

figure;
imshow(bw);


% Try the filter again
%bflt2 = bfilter2(bflt,w,sigma);

%figure;
%imshow(bflt2);

color = zeros(size(bw, 1),size(bw, 2));

for(i=0; i < size(bw, 1); i++)
    for(j=0; j < size(bw, 2); j++)
        if(bw(i, j) > 170)
            color(i, j, 1) = 255;
        else if((bw(i, j) > 85 && bw(i,j)